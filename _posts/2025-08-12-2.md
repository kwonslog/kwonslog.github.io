---
layout: single
title: "LLM 입문 하기 전에 기초 다지기 "
excerpt: "LLM, RAG 를 가지고 뭔가를 하고 싶은데 그 전에 뭐가 있는지 부터 알아가는 과정을 기록한다."
date: 2025-08-12
last_modified_at: 2025-08-12
categories: [AI]
tags: [LLM, RAG]
toc: true
---

# 0일차 — 환경 준비

* 목표: Windows에서 파이썬 가상환경 + LLM 기본 실행.
* 내용: `.venv` 구성, 필수 패키지 설치, GPU/CPU 설정, 첫 파이프라인 테스트.
* 실습: `pipeline("text-generation")`로 헬로월드.
* 완료 기준: 모델 로드·한 줄 생성 성공, 버전 고정 기록.

# 1일차 — LLM 기본 개념 & 생성 파이프라인

* 목표: 토큰→임베딩→Attention/FFN→logits→softmax 전체 흐름 이해.
* 내용: logit/확률, vocabulary size, special tokens 개념.
* 실습: temperature/top\_k/top\_p/repetition\_penalty/no\_repeat\_ngram\_size 실험.
* 완료 기준: 파라미터가 출력에 주는 영향 설명·데모 가능.

# 2일차 — 프롬프트 엔지니어링(기초)

* 목표: **역할(Role)·지시(Instruction)·예시(Few-shot)** 구조 습득.
* 내용: 시스템/유저/어시스턴트 메시지, 출력 포맷(JSON/Markdown) 강제.
* 실습: 같은 질문에 프롬프트만 바꿔 비교.
* 완료 기준: 과제별 프롬프트 템플릿 3종 작성.

# 3일차 — 토크나이저 & Vocabulary 심화

* 목표: BPE 동작, OOV 처리, special tokens(BOS/EOS/PAD).
* 내용: 토큰 ID↔문자열, add\_special\_tokens 옵션, 길이/단위.
* 실습: 한국어/영문 혼합 문장 토큰화, OOV 분해 관찰.
* 완료 기준: vocab\_size 의미 설명 + OOV 실습 결과 해석.

# 4일차 — 추론(Decoding) 전략

* 목표: Greedy, Beam, Sampling(top-k/top-p) 비교·선택 기준 습득.
* 내용: 동작 순서(temperature→top\_k→top\_p→sampling), beam 길이 패널티.
* 실습: 동일 프롬프트로 전략별 결과·속도 비교.
* 완료 기준: 작업별(요약/번역/대화) 최적 전략 선택 근거 제시.

# 5일차 — Pretraining vs Fine-tuning + LoRA/QLoRA

* 목표: 사전학습/미세조정 차이와 저랭크 학습 이해.
* 내용: SFT/Instruction/Chat 튜닝, LoRA(r/alpha/target\_modules), QLoRA(4bit).
* 실습: SFTTrainer + LoRA 구조 세팅(미니 데이터로 드라이런).
* 완료 기준: 학습 파이프라인 코드 설명·수정 가능.

# 6일차 — 프롬프트 구조 & 컨텍스트 윈도우

* 목표: 컨텍스트 제한과 긴 문서 처리.
* 내용: 윈도우/슬라이딩/요약 삽입, stop 시퀀스, truncation 전략.
* 실습: 긴 문서 토큰 길이 측정→슬라이딩 윈도우 적용.
* 완료 기준: 길이 제약 하에서 품질 유지 전략 제시.

## 학습 내용
 - 컨텍스트 윈도우 제한을 초과하는 긴 문서의 경우 아래 단계를 통해 처리 된다.
   1. 정리/중복 제거
   2. 선별
   3. 요약
   4. 압축
   5. 우선순위 절단
 - 각 단계별 진행 여부는 토큰 게이트와 품질 게이트 기준을 만족하지 않으면 다음 단계로 넘어간다.
   - 토큰 게이트(TG)는 현재 계산된 프롬프트(입력 토큰)의 길이가 모델의 컨텍스트 윈도우 안에 들어오는지 판정하는 규칙.
   - 품질 게이트(QG)는 토큰을 줄인 뒤에도 정답 품질이 유지되는지 확인하는 규칙.

 - 학습 내용 요약 : 긴 문서를 컨텍스트 윈도우의 크기에 맞게 안정적으로 처리 하기 위한 방법에 관한 내용이었다.

## Q & A

1. **프롬프트 구조와 컨텍스트 윈도우의 관계는?**  
   - 컨텍스트 윈도우는 입력과 출력 가능한 토큰의 최대 용량을 말한다.
     예를 들어 컨텍스트 윈도우가 4K 라면 입력과 출력 토큰은 최대 4K 를 넘을수 없다.
   - 프롬프트 구조는 일반적으로 아래와 같은 구조를 가진다.
     1. 시스템 메시지
     2. 컨텍스트(지식/배경정보)
     3. 질문 또는 지시사항
     4. 예시
    
2. ** chatgpt.com 의 웹 버전 대화형 인터페이스에서 프롬프트 구조를 사용해 보면?**
   - 아래와 같이 필요한 항목만 프롬프트에 포함하여 작성하였다.
   ```
   [시스템 메시지]
   1.당신은 AI, LLM, RAG 분야의 전문가 입니다.
   2.설명은 단계별로 하고 이해하기 쉬운 표현을 사용하여 작성합니다.

   [지시사항]
   1. 주어진 주제를 체계적으로 설명합니다.  
   2. 각 단계별로 번호를 매기고, 핵심 개념 → 예시 → 응용 순서로 구성합니다.  
   3. 불필요한 전문용어는 배제하거나, 반드시 쉬운 설명을 덧붙입니다.  
   4. 설명이 끝나면 간단한 요약을 제공합니다.

   [질문]
   few-shot 의 개념과 왜 사용하는지 목적에 대해 설명해줘.
   ```
   - 프롬프트를 여러번 요청하면 그때마다 답변은 모두 다르게 나왔지만 프롬프트에 입력한 사항들을 지키는 것은 일관성이 있어 보였다.

# 7일차 — 임베딩(Embeddings) 기초

* 목표: 임베딩 벡터와 유사도 지표 이해.
* 내용: 코사인/내적/유클리드, 정규화, 차원/분산.
* 실습: 한국어 임베딩 모델 2\~3종 비교, 쿼리-문서 유사도 Top-N.
* 완료 기준: 임베딩 선택·전처리(정규화) 근거 설명.

# 8일차 — 벡터 스토어 선택과 구축

* 목표: FAISS vs Elasticsearch/OpenSearch 아키텍처 비교.
* 내용: HNSW/IVF/Flat, 인덱스·파라미터(efSearch/nprobe) 개념.
* 실습: FAISS 인덱스 구축·검색, ES KNN 간단 비교.
* 완료 기준: PoC/프로덕션 각각의 최선 선택안 제시.

# 9일차 — 청킹(Chunking) & 검색 품질 향상

* 목표: 청킹 전략이 검색 품질에 미치는 영향 이해.
* 내용: 문장/문단/토큰 기반, 오버랩, 메타데이터(섹션/제목/태그).
* 실습: 동일 코퍼스에 전략별 검색 성능 비교(MMR·RRR 등).
* 완료 기준: 프로젝트에 맞는 청킹 파라미터 결정.

# 10일차 — 리랭킹(Reranking)

* 목표: retriever 상위 k 재정렬로 정답률 향상.
* 내용: Cross-encoder(bge-reranker 등), 레이턴시/비용 트레이드오프.
* 실습: 검색→리랭킹 전/후 정답률·클릭로그 비교.
* 완료 기준: 리랭킹 도입 기준과 임계치(Top-K, 임계 스코어) 정의.

# 11일차 — RAG 파이프라인 조립(End-to-End)

* 목표: Retriever → (Reranker) → Generator 통합.
* 내용: 컨텍스트 주입 프롬프트, 출처 인용, 쿼리 확장(hyDE 등).
* 실습: 질문→검색→생성→인용까지 작동하는 E2E 구축.
* 완료 기준: 로컬 데모 API(예: FastAPI) 제공.

# 12일차 — RAG 평가 & 자동화

* 목표: 정량/정성 평가 체계 수립.
* 내용: RAGAS/LLM-as-Judge, Faithfulness/Groundedness 지표.
* 실습: 미니 테스트셋으로 자동 평가 파이프라인 실행.
* 완료 기준: 기준치 미달 케이스 자동 리포트 생성.

# 13일차 — 운영·배포(백엔드 관점)

* 목표: 서비스 레디 파이프라인.
* 내용: FastAPI/스트리밍, **Spring Boot 연동**(REST/gRPC), 캐시 전략, 타임아웃/재시도.
* 실습: 자바 백엔드에서 RAG API 호출·리트라이·서킷브레이커.
* 완료 기준: 운영용 설정값(타임아웃/병렬/캐시) 문서화.

# 14일차 — 보안·최적화·가드레일

* 목표: 안전·성능·비용 최적화.
* 내용: 프롬프트 인젝션 방어, 데이터 유출 차단, 권한 분리, 양자화(AWQ/GPTQ/4-bit), 가드레일(금칙어/정책 프롬프트).
* 실습: 어뷰징 프롬프트 테스트 & 방어 템플릿 적용, 4bit 추론 속도 비교.
* 완료 기준: 보안 체크리스트 + 성능/비용 벤치 결과.

---

필요하면 각 일차를 **한 장 요약(목표/핵심/실습/완료 기준)** 카드로 쪼개서 드릴게.
바로 **6일차**부터 들어갈까, 아니면 5일차 심화 보충부터 마무리할까?




